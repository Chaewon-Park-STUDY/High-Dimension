#진행중

```r
install.packages("faraway")
library("faraway")     #  통계 교재 예제 데이터셋을 불러옴

#stat500 example

data(stat500)
head(stat500)
#dim(stat500)

#SLR
plot(final~midterm, data=stat500) #scatterplot

lm(final~midterm, data=stat500)

abline(lm(final~midterm, data=stat500), col="red")


plot(final~midterm, data=stat500)
fit=lm(final~midterm, data=stat500)
abline(coef(fit), col="red", lty=2)


fit= lm(final~midterm, data=stat500)
names(fit)

summary(fit)



#MLR
data(stat500)
lm(final~midterm+hw, data=stat500)

summary(lm(final~midterm+hw, data=stat500))

#OLS estimator
X=stat500[,c(1,3)]; y=stat500[,2]  # 행,열 --> 행은 전부 다 가져옴 X는 1열과 3열 즉, midterm과 hw만 가져오고 y는 2열인 final만 가져옴
X=cbind(rep(1,nrow(X)),X)
X=as.matrix(X);y=as.matrix(y)


OLS=solve(t(X)%*%X, t(X)%*%y)
OLS
lm(final~midterm+hw, data=stat500)$coefficients

```


```r
#Galapagos Islands example
library("faraway")
data(gala)
head(gala)

fit=lm(Species~Area+Elevation+Scruz+Adjacent, data=gala)
fit

y=gala$Species
R2= 1-deviance(fit)/sum((y-mean(y))^2)
R2


n=30;p=4
R2_adjusted=1-(1-R2)*(n-1)/(n-p-1)
R2_adjusted


summary(fit)



fit2=lm(Species~Area+Elevation+Scruz+Adjacent+Nearest, data=gala)
fit2

y=gala$Species
R2= 1-deviance(fit2)/sum((y-mean(y))^2)
R2


n=30;p=5
R2_adjusted=1-(1-R2)*(n-1)/(n-p-1)
R2_adjusted


summary(fit2)


fit=lm(Species~Area+Elevation+Scruz+Adjacent, data=gala)
names(fit)


n=30;p=4
SST=sum((gala$Species-mean(gala$Species))^2)
SSE=deviance(fit)
MSE=SSE/fit$df.residual
SSR=SST-SSE
MSR=SSR/p
Fstat=MSR/MSE


crit_value=qf(0.95, p, n-p-1)
Fstat>crit_value #reject H0

pvalue=1-pf(Fstat,p,n-p-1)
pvalue<0.05       #reject H0

```



```r
#savings Example
library("faraway")
data(savings)
head(savings)


fit2=lm(sr ~., data=savings)

n=nrow(savings); p= ncol(savings)-1
SST2=sum((savings$sr-mean(savings$sr))^2)
SSE2=deviance(fit2)
MSE2=SSE2/fit2$df.residual    #fit$df.residual=n-p-1
SSR2=SST2-SSE2
MSR2=SSR2/p
Fstat2= MSR2/MSE2

#Is pop75 significant in the full model?
fit2=lm(sr~., data=savings)
fit1= lm(sr~pop15+dpi+ddpi, savings)
SSE1= deviance(fit1)
Fstat=(SSE1-SSE2)/(SSE2/(n-p-1))
1-pf(Fstat,1,n-p-1) #p-value

2*pt(-1.561,n-p-1) #compute p-value using t- distribution


anova(fit1,fit2)

